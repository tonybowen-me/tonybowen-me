---
import { getCollection } from "astro:content";
import Base from "../layouts/Base.astro";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<Base title="Tony Bowen" description="Tony Bowen's personal blog">
  <section class="about about-compact">
    <h1>Hey, I'm Tony!</h1>
    <p>
      Technology leader, software engineer, and chronic hyper-fixator. I write about what I'm building and whatever else catches my interest. <a href="/about/">More about me &rarr;</a>
    </p>
  </section>

  <section>
    <h2 class="section-heading">Posts</h2>
    {
      posts.length === 0 ? (
        <p style="color: var(--color-text-muted);">No posts yet. Check back soon.</p>
      ) : (
        <ul class="post-grid">
          {posts.map((post) => (
            <li class="post-card">
              <a href={`/blog/${post.id}/`} class="post-card-link">
                {post.data.thumbnail ? (
                  <img
                    src={post.data.thumbnail}
                    alt={post.data.title}
                    class="post-card-image"
                    loading="lazy"
                  />
                ) : (
                  <div class="post-card-placeholder" />
                )}
                <h3 class="post-card-title">{post.data.title}</h3>
              </a>
            </li>
          ))}
        </ul>
      )
    }
  </section>
</Base>
