---
import { getCollection, render } from "astro:content";
import Base from "../../layouts/Base.astro";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);

const formattedDate = post.data.date.toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
  timeZone: "UTC",
});
---

<Base title={post.data.title} description={post.data.description}>
  <a href="/" class="back-link">&larr; Back to home</a>

  <article>
    <header class="post-header">
      <h1 class="post-title">{post.data.title}</h1>
      <p class="post-date">
        <time datetime={post.data.date.toISOString()}>{formattedDate}</time>
      </p>
    </header>

    <div class="post-content">
      <Content />
    </div>
  </article>

  <div style="margin-top: var(--space-xl);">
    <a href="/" class="back-link">&larr; Back to home</a>
  </div>
</Base>
